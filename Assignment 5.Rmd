---
title: "Female academic trajectories (1967-2015)"
author: "Joanna Tang, Sandro Lallas, Rachem Behm"
date: "11/27/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include = FALSE}
# Outline

# 0. Load in packages and read in data
# 1a. Line graph with 6 lines: Total Males, Total Females, Full-time-males, Full-time-females, Part-time-males, Part-time-females, Public, Private-total
# 1b. Pairwise Chi-squared tests
# 2a. Bar graph, with 1 bar for each subject
# 2b. Pairwise Chi-squared tests
# 3a. Table for male vs female postdoc positions, male vs female non-postdoc positions
# 3b. Pairwise Chi-squared tests
# 4. Multivariable LM

```


```{r include = FALSE}

# 0. Load packages and read in data

library(tidyverse)
library(vcdExtra)
library(knitr)
library(kableExtra)
library(RColorBrewer)
library(car)
library(effsize)
library(kableExtra)
library(formattable)
library(stargazer)

faculty_salary <- read_csv("Faculty salary data.csv") %>% rename("Years_since" = "Years Since PhD") %>% rename("Years" = "Years Faculty Service") %>% rename("Rank" = "Faculty Rank")
grad_enrollment <- read_csv("Grad enrollment.csv") %>% rename("Males" = "Total Males") %>% rename("Females" = "Total Females") %>% rename("Full_time_males" = "Full-time-males") %>% rename("Full_time_females" = "Full-time-females") %>% rename("Part_time_males" = "Part-time-males") %>% rename("Part_time_females" = "Part-time-females") %>% rename("Private_total" = "Private-total")
median_salary <- read_csv("Median salary for doctoral recipients.csv") %>% rename("Total_male" = "Total employment male") %>% rename("Total_female" = "Total employment femal") %>% rename("Postdoc_male" = "Postdoc male") %>% rename("Postdoc_female" = "Postdoc female")
phd_field <- read_csv("PhDs by Field.csv") %>% mutate(Percent = Proportion*100)

```



#INTRODUCTION

#DATA, DATA ANALYSIS, & STATISTICAL METHODS

#RESULTS

##Male and female graduate enrollment (1967-2015)

```{r echo = FALSE, message = FALSE, warning= FALSE}

# 1a. 4 line graphs with 2 lines each: Total Males, Total Females, Full-time-males, Full-time-females, Part-time-males, Part-time-females, Public, Private-total

grad_enrollment_total <- ggplot(grad_enrollment, aes(x = Year)) +
  geom_line(aes(y = Males), color = "red") +
  geom_line(aes(y = Females), color = "blue")
grad_enrollment_total

grad_enrollment_full <- ggplot(grad_enrollment, aes(x = Year)) +
  geom_line(aes(y = Full_time_males), color = "red") +
  geom_line(aes(y = Full_time_females), color = "blue")
grad_enrollment_full

grad_enrollment_part <- ggplot(grad_enrollment, aes(x = Year)) +
  geom_line(aes(y = Part_time_males), color = "red") +
  geom_line(aes(y = Part_time_females), color = "blue")
grad_enrollment_part

grad_enrollment_public_private <- ggplot(grad_enrollment, aes(x = Year)) +
  geom_line(aes(y = Public), color = "orange") +
  geom_line(aes(y = Private_total), color = "green")
grad_enrollment_public_private

```

```{r include = FALSE}

# 1b. Pairwise Chi-squared tests

# Contingency table of grad_enrollment
grad_enrollment_contingency <- select(grad_enrollment, "Males", "Females", "Full_time_males", "Full_time_females", "Part_time_males", "Part_time_females", "Public", "Private_total")

rownames(grad_enrollment_contingency) <- seq(1967,2015)

chi_total <- chisq.test(select(grad_enrollment_contingency, "Males", "Females"))
chi_total #p < .001, year affects proportion of males vs females

chi_full <- chisq.test(select(grad_enrollment_contingency, "Full_time_males", "Full_time_females"))
chi_full #p < .001, year affects proportion of full-time males vs females

chi_part <- chisq.test(select(grad_enrollment_contingency, "Part_time_males", "Part_time_females"))
chi_part #p < .001, year affects proportion of part-time males vs females

chi_public_private <- chisq.test(select(grad_enrollment_contingency, "Public", "Private_total"))
chi_public_private #p < .001, year affects proportion of public vs private


```

##Shifts in female PhD recipients

```{r echo = FALSE, message = FALSE, warning= FALSE}

# 2a. Bar graph with 1 bar for each subject

female_phd <- phd_field %>% 
  filter(Sex == "Female",
         Field == "Physical sciences and earth sciences" |
         Field == "Engineering" |
         Field == "Education" |
         Field == "Humanities and arts",
         Year == "1985" |
         Year == "2000" |
         Year == "2015")

female_phd_graph <- ggplot(female_phd, aes(x = Year)) +
  geom_col(aes(y = Number, fill = Field), position = "dodge")
  
female_phd_graph

# Alternate graph based on field: female_phd_field_graph <- ggplot(female_phd, aes(x = Field,)) + geom_col(aes(y = Number, fill = as.factor(Year)), position = "dodge")

```

```{r include = FALSE}
# 2b. Pairwise Chi-squared tests

# Converting female_phd into contingency table

female_phd_contingency <- select(female_phd, "Field", "Number", "Year") %>%
  spread(Field, Number) %>% 
  select(-Year)

rownames(female_phd_contingency) <- c("1985", "2000", "2015")


female_phd_ed_chi <- chisq.test(select(female_phd_contingency, "Education"))
female_phd_ed_chi #p < .001, year affects proportion

female_phd_eng_chi <- chisq.test(select(female_phd_contingency, "Engineering"))
female_phd_eng_chi #p < .001, year affects proportion

female_phd_ha_chi <- chisq.test(select(female_phd_contingency, "Humanities and arts"))
female_phd_ha_chi #p < .001, year affects proportion

female_phd_pe_chi <- chisq.test(select(female_phd_contingency, "Physical sciences and earth sciences"))
female_phd_pe_chi #p < .001, year affects proportion


```

##Male and female salaries for starting postdoctoral and other employment positions (2015)

```{r echo = FALSE, message = FALSE, warning= FALSE}

# 3a. Table for male vs female postdoc positions, male vs female non-postdoc positions


#Simplifying 
starting_salary <- median_salary %>% 
  summarize(
    median_female = median(Total_female),
    median_male = median(Total_male),
    se_female = se(Total_female),
    se_male = se(Total_male)
  )
starting_salary

starting_salary_postdoc <- median_salary %>% 
  summarize(
    median_postdoc_female = median(Postdoc_female),
    median_postdoc_male = median(Postdoc_male),
    se_female = se(Postdoc_female),
    se_male = se(Postdoc_male)
  )
starting_salary_postdoc

```

```{r include = FALSE}

# 3b. Pairwise Mann-Whitney U + Cliff's Delta (effect size)

starting_salary_mwu <- wilcox.test(median_salary$Total_male, median_salary$Total_female)
starting_salary_mwu #p = .3289, medians the same

starting_salary_cliff <- cliff.delta(median_salary$Total_male, median_salary$Total_female)
starting_salary_cliff #delta = .213 (small)


starting_salary_postdoc_mwu <- wilcox.test(median_salary$Postdoc_male, median_salary$Postdoc_female)
starting_salary_postdoc_mwu #p = .8671, medians the same

starting_salary_postdoc_cliff <- cliff.delta(median_salary$Postdoc_male, median_salary$Postdoc_female)
starting_salary_postdoc_cliff #delta = .04 (small)

```


##Academic salaries for professors in U.S. colleges

```{r echo = FALSE, message = FALSE, warning= FALSE}

# 4. Multivariable LM

faculty_salary$Rank <- fct_relevel(faculty_salary$Rank, "AsstProf")

faculty_salary_lm_sat <- lm(Salary ~ Sex + Rank + Years + Discipline + Years_since, data = faculty_salary)

summary(faculty_salary_lm_sat)

plot(faculty_salary_lm_sat)

sat_aic <- AIC(faculty_salary_lm_sat)
sat_aic

```

#DISCUSSION

##Female graduate enrollment is increasing over time

##Shifts in female PhD recipients over time

##Starting salaries for female PhD recipients in 2015

##Academic salaries for US professors (2008-2009)

#CONCLUSION

#REFERENCES
